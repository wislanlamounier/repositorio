var labelType, useGradients, nativeTextSupport, animate;

(function() {
  var ua = navigator.userAgent,
      iStuff = ua.match(/iPhone/i) || ua.match(/iPad/i),
      typeOfCanvas = typeof HTMLCanvasElement,
      nativeCanvasSupport = (typeOfCanvas == 'object' || typeOfCanvas == 'function'),
      textSupport = nativeCanvasSupport 
        && (typeof document.createElement('canvas').getContext('2d').fillText == 'function');
  //I'm setting this based on the fact that ExCanvas provides text support for IE
  //and that as of today iPhone/iPad current text support is lame
  labelType = (!nativeCanvasSupport || (textSupport && !iStuff))? 'Native' : 'HTML';
  nativeTextSupport = labelType == 'Native';
  useGradients = nativeCanvasSupport;
  animate = !(iStuff || !nativeCanvasSupport);
})();

var Log = {
  elem: false,
  write: function(text){
    if (!this.elem) 
      this.elem = document.getElementById('log');
    this.elem.innerHTML = text;
    this.elem.style.left = (350 - this.elem.offsetWidth / 2) + 'px';
    this.elem.style.color = '#777';
  }
};


function init(){
    //init data
	///var json = {"name":"Francivaldo","id":"1208575","data":"","children":[{"data":"","id":"1554014","name":"1554014","children":[{"data":"","id":"1134221","name":"1134221","children":[{"data":"","id":"2389765","name":"2389765","children":[{"data":"","id":"1288023","name":"1288023","children":[{"data":"","id":"1417943","name":"1417943","children":[]}]},{"data":"","id":"1126067","name":"1126067","children":[]},{"data":"","id":"3020683","name":"3020683","children":[]},{"data":"","id":"1686339","name":"1686339","children":[]},{"data":"","id":"1092960","name":"1092960","children":[]}]},{"data":"","id":"1159967","name":"1159967","children":[{"data":"","id":"1094835","name":"1094835","children":[]},{"data":"","id":"1976693","name":"1976693","children":[]},{"data":"","id":"1030462","name":"1030462","children":[{"data":"","id":"1426668","name":"1426668","children":[]},{"data":"","id":"1107499","name":"1107499","children":[]}]},{"data":"","id":"1904906","name":"1904906","children":[{"data":"","id":"1362595","name":"1362595","children":[]}]},{"data":"","id":"1968331","name":"1968331","children":[]}]},{"data":"","id":"1040958","name":"1040958","children":[{"data":"","id":"1048476","name":"1048476","children":[]},{"data":"","id":"1080322","name":"1080322","children":[]},{"data":"","id":"1960451","name":"1960451","children":[]},{"data":"","id":"2033383","name":"2033383","children":[]},{"data":"","id":"1081035","name":"1081035","children":[]}]},{"data":"","id":"1386935","name":"1386935","children":[{"data":"","id":"1772576","name":"1772576","children":[{"data":"","id":"1133698","name":"1133698","children":[]},{"data":"","id":"1109325","name":"1109325","children":[]}]},{"data":"","id":"1400002","name":"1400002","children":[]},{"data":"","id":"1583027","name":"1583027","children":[]},{"data":"","id":"1502552","name":"1502552","children":[]},{"data":"","id":"1972515","name":"1972515","children":[]}]},{"data":"","id":"1026557","name":"1026557","children":[{"data":"","id":"1037955","name":"1037955","children":[{"data":"","id":"1419662","name":"1419662","children":[{"data":"","id":"1242249","name":"1242249","children":[{"data":"","id":"2375319","name":"2375319","children":[]},{"data":"","id":"1030581","name":"1030581","children":[]}]},{"data":"","id":"1117944","name":"1117944","children":[{"data":"","id":"1278780","name":"1278780","children":[]},{"data":"","id":"1358586","name":"1358586","children":[]},{"data":"","id":"1012195","name":"1012195","children":[{"data":"","id":"1146659","name":"1146659","children":[]},{"data":"","id":"1479210","name":"1479210","children":[{"data":"","id":"1312634","name":"1312634","children":[]},{"data":"","id":"1202818","name":"1202818","children":[]},{"data":"","id":"1286705","name":"1286705","children":[]}]}]}]},{"data":"","id":"1095937","name":"1095937","children":[{"data":"","id":"1143280","name":"1143280","children":[]}]},{"data":"","id":"1039514","name":"1039514","children":[]},{"data":"","id":"1022411","name":"1022411","children":[{"data":"","id":"1319346","name":"1319346","children":[]}]}]},{"data":"","id":"1334054","name":"1334054","children":[{"data":"","id":"1673782","name":"1673782","children":[]},{"data":"","id":"1574575","name":"1574575","children":[{"data":"","id":"1590991","name":"1590991","children":[]}]},{"data":"","id":"1040763","name":"1040763","children":[]},{"data":"","id":"1218152","name":"1218152","children":[]},{"data":"","id":"1284586","name":"1284586","children":[]}]},{"data":"","id":"1413916","name":"1413916","children":[{"data":"","id":"1141677","name":"1141677","children":[]},{"data":"","id":"1290378","name":"1290378","children":[]},{"data":"","id":"1467942","name":"1467942","children":[]},{"data":"","id":"1322027","name":"1322027","children":[]},{"data":"","id":"1465740","name":"1465740","children":[]}]},{"data":"","id":"1419496","name":"1419496","children":[{"data":"","id":"1725484","name":"1725484","children":[]},{"data":"","id":"2101070","name":"2101070","children":[]},{"data":"","id":"1241796","name":"1241796","children":[{"data":"","id":"1167216","name":"1167216","children":[]},{"data":"","id":"1133704","name":"1133704","children":[]}]},{"data":"","id":"2915390","name":"2915390","children":[{"data":"","id":"1442613","name":"1442613","children":[]}]},{"data":"","id":"1035843","name":"1035843","children":[]}]},{"data":"","id":"1209897","name":"1209897","children":[{"data":"","id":"1508735","name":"1508735","children":[]},{"data":"","id":"2405415","name":"2405415","children":[]},{"data":"","id":"1325976","name":"1325976","children":[]},{"data":"","id":"1013755","name":"1013755","children":[]},{"data":"","id":"1155039","name":"1155039","children":[]}]}]},{"data":"","id":"1325416","name":"1325416","children":[{"data":"","id":"2248994","name":"2248994","children":[]},{"data":"","id":"1229438","name":"1229438","children":[]},{"data":"","id":"1104631","name":"1104631","children":[]},{"data":"","id":"1083495","name":"1083495","children":[]},{"data":"","id":"1697137","name":"1697137","children":[]}]},{"data":"","id":"1439897","name":"1439897","children":[{"data":"","id":"1601348","name":"1601348","children":[]},{"data":"","id":"1013601","name":"1013601","children":[]}]},{"data":"","id":"1911347","name":"1911347","children":[]},{"data":"","id":"1670781","name":"1670781","children":[]}]}]},{"data":"","id":"1948342","name":"1948342","children":[{"data":"","id":"1963385","name":"1963385","children":[{"data":"","id":"1161252","name":"1161252","children":[]},{"data":"","id":"1881073","name":"1881073","children":[]},{"data":"","id":"1969677","name":"1969677","children":[]},{"data":"","id":"1002634","name":"1002634","children":[]},{"data":"","id":"1351763","name":"1351763","children":[]}]},{"data":"","id":"1493889","name":"1493889","children":[{"data":"","id":"1065801","name":"1065801","children":[]}]},{"data":"","id":"1235715","name":"1235715","children":[]},{"data":"","id":"1455846","name":"1455846","children":[]},{"data":"","id":"2179346","name":"2179346","children":[]}]},{"data":"","id":"2192097","name":"2192097","children":[{"data":"","id":"1049624","name":"1049624","children":[{"data":"","id":"1146969","name":"1146969","children":[{"data":"","id":"1201283","name":"1201283","children":[]}]},{"data":"","id":"1803035","name":"1803035","children":[]}]},{"data":"","id":"1671628","name":"1671628","children":[]},{"data":"","id":"1247139","name":"1247139","children":[]},{"data":"","id":"1852363","name":"1852363","children":[]},{"data":"","id":"1706742","name":"1706742","children":[]}]},{"data":"","id":"1344682","name":"1344682","children":[{"data":"","id":"1742768","name":"1742768","children":[{"data":"","id":"1036130","name":"1036130","children":[{"data":"","id":"1509276","name":"1509276","children":[]},{"data":"","id":"1569543","name":"1569543","children":[{"data":"","id":"1381155","name":"1381155","children":[]},{"data":"","id":"1985237","name":"1985237","children":[]}]},{"data":"","id":"1021739","name":"1021739","children":[{"data":"","id":"1145728","name":"1145728","children":[]},{"data":"","id":"1650306","name":"1650306","children":[]},{"data":"","id":"1213021","name":"1213021","children":[]}]},{"data":"","id":"1302222","name":"1302222","children":[]}]},{"data":"","id":"1477633","name":"1477633","children":[]},{"data":"","id":"1524027","name":"1524027","children":[{"data":"","id":"1008039","name":"1008039","children":[{"data":"","id":"1503779","name":"1503779","children":[{"data":"","id":"1085895","name":"1085895","children":[{"data":"","id":"1550704","name":"1550704","children":[]}]},{"data":"","id":"1882548","name":"1882548","children":[]},{"data":"","id":"1063390","name":"1063390","children":[]},{"data":"","id":"1955209","name":"1955209","children":[]},{"data":"","id":"1315061","name":"1315061","children":[]}]},{"data":"","id":"1156335","name":"1156335","children":[{"data":"","id":"1278327","name":"1278327","children":[]}]}]}]},{"data":"","id":"1564749","name":"1564749","children":[{"data":"","id":"1500771","name":"1500771","children":[]}]},{"data":"","id":"1531566","name":"1531566","children":[]}]},{"data":"","id":"1487130","name":"1487130","children":[{"data":"","id":"1799787","name":"1799787","children":[{"data":"","id":"1070303","name":"1070303","children":[]},{"data":"","id":"1029188","name":"1029188","children":[]},{"data":"","id":"1214489","name":"1214489","children":[]},{"data":"","id":"1849652","name":"1849652","children":[]}]},{"data":"","id":"1716725","name":"1716725","children":[]},{"data":"","id":"1004781","name":"1004781","children":[]},{"data":"","id":"1836366","name":"1836366","children":[]},{"data":"","id":"1043188","name":"1043188","children":[{"data":"","id":"1068710","name":"1068710","children":[]},{"data":"","id":"1708736","name":"1708736","children":[]},{"data":"","id":"1182834","name":"1182834","children":[]}]}]},{"data":"","id":"2590407","name":"2590407","children":[{"data":"","id":"1236913","name":"1236913","children":[{"data":"","id":"1279337","name":"1279337","children":[{"data":"","id":"1252144","name":"1252144","children":[]}]},{"data":"","id":"1006186","name":"1006186","children":[{"data":"","id":"1063662","name":"1063662","children":[{"data":"","id":"1216465","name":"1216465","children":[]},{"data":"","id":"1262853","name":"1262853","children":[]},{"data":"","id":"1149557","name":"1149557","children":[]},{"data":"","id":"2794182","name":"2794182","children":[]},{"data":"","id":"1507327","name":"1507327","children":[]}]},{"data":"","id":"1751998","name":"1751998","children":[]},{"data":"","id":"1284762","name":"1284762","children":[]},{"data":"","id":"1135595","name":"1135595","children":[]},{"data":"","id":"1312434","name":"1312434","children":[]}]}]},{"data":"","id":"1030946","name":"1030946","children":[]},{"data":"","id":"1748791","name":"1748791","children":[{"data":"","id":"1830229","name":"1830229","children":[]},{"data":"","id":"2711018","name":"2711018","children":[]}]},{"data":"","id":"1255171","name":"1255171","children":[]},{"data":"","id":"1481490","name":"1481490","children":[{"data":"","id":"2001442","name":"2001442","children":[{"data":"","id":"1334665","name":"1334665","children":[]},{"data":"","id":"1238057","name":"1238057","children":[]},{"data":"","id":"1060513","name":"1060513","children":[{"data":"","id":"1480519","name":"1480519","children":[{"data":"","id":"1345058","name":"1345058","children":[]}]},{"data":"","id":"1522614","name":"1522614","children":[]}]},{"data":"","id":"1274237","name":"1274237","children":[]}]},{"data":"","id":"1132335","name":"1132335","children":[]},{"data":"","id":"1650092","name":"1650092","children":[]}]}]},{"data":"","id":"2214516","name":"2214516","children":[{"data":"","id":"1373851","name":"1373851","children":[{"data":"","id":"1052263","name":"1052263","children":[]},{"data":"","id":"3299309","name":"3299309","children":[{"data":"","id":"1187723","name":"1187723","children":[{"data":"","id":"1751268","name":"1751268","children":[]},{"data":"","id":"1019446","name":"1019446","children":[]}]},{"data":"","id":"1074242","name":"1074242","children":[]},{"data":"","id":"1202711","name":"1202711","children":[]},{"data":"","id":"1992853","name":"1992853","children":[]},{"data":"","id":"1812582","name":"1812582","children":[]}]},{"data":"","id":"1281059","name":"1281059","children":[]},{"data":"","id":"1474248","name":"1474248","children":[]},{"data":"","id":"1093098","name":"1093098","children":[{"data":"","id":"1523615","name":"1523615","children":[]},{"data":"","id":"1271763","name":"1271763","children":[]},{"data":"","id":"1359642","name":"1359642","children":[]},{"data":"","id":"1341875","name":"1341875","children":[]},{"data":"","id":"1629793","name":"1629793","children":[]}]}]},{"data":"","id":"1990658","name":"1990658","children":[{"data":"","id":"1073651","name":"1073651","children":[{"data":"","id":"1106622","name":"1106622","children":[]},{"data":"","id":"1027467","name":"1027467","children":[]},{"data":"","id":"1447536","name":"1447536","children":[]}]},{"data":"","id":"1002030","name":"1002030","children":[{"data":"","id":"1263835","name":"1263835","children":[{"data":"","id":"1522530","name":"1522530","children":[]},{"data":"","id":"2173659","name":"2173659","children":[]}]},{"data":"","id":"1216200","name":"1216200","children":[]},{"data":"","id":"1442591","name":"1442591","children":[]}]},{"data":"","id":"2715894","name":"2715894","children":[]},{"data":"","id":"1027966","name":"1027966","children":[{"data":"","id":"1129126","name":"1129126","children":[{"data":"","id":"1085888","name":"1085888","children":[{"data":"","id":"1211607","name":"1211607","children":[]},{"data":"","id":"1053754","name":"1053754","children":[]}]},{"data":"","id":"1463479","name":"1463479","children":[]}]},{"data":"","id":"1112226","name":"1112226","children":[]},{"data":"","id":"1131689","name":"1131689","children":[{"data":"","id":"1068653","name":"1068653","children":[]},{"data":"","id":"2197497","name":"2197497","children":[]}]},{"data":"","id":"1079164","name":"1079164","children":[]},{"data":"","id":"1496400","name":"1496400","children":[{"data":"","id":"1050420","name":"1050420","children":[]}]}]},{"data":"","id":"1082529","name":"1082529","children":[]}]},{"data":"","id":"1095861","name":"1095861","children":[{"data":"","id":"1249039","name":"1249039","children":[]}]},{"data":"","id":"1183038","name":"1183038","children":[]},{"data":"","id":"1491035","name":"1491035","children":[]}]},{"data":"","id":"1000702","name":"1000702","children":[]}]},{"data":"","id":"1281185","name":"1281185","children":[{"data":"","id":"1239668","name":"1239668","children":[{"data":"","id":"1990848","name":"1990848","children":[{"data":"","id":"1339358","name":"1339358","children":[{"data":"","id":"1415980","name":"1415980","children":[{"data":"","id":"1419987","name":"1419987","children":[]},{"data":"","id":"1347714","name":"1347714","children":[{"data":"","id":"1602093","name":"1602093","children":[]}]},{"data":"","id":"1460828","name":"1460828","children":[]}]},{"data":"","id":"1362427","name":"1362427","children":[]},{"data":"","id":"1921984","name":"1921984","children":[]},{"data":"","id":"1340065","name":"1340065","children":[]},{"data":"","id":"1727511","name":"1727511","children":[]}]},{"data":"","id":"2116090","name":"2116090","children":[{"data":"","id":"2382512","name":"2382512","children":[]},{"data":"","id":"1422064","name":"1422064","children":[]},{"data":"","id":"1030363","name":"1030363","children":[]},{"data":"","id":"1403099","name":"1403099","children":[]},{"data":"","id":"1068783","name":"1068783","children":[]}]},{"data":"","id":"1032150","name":"1032150","children":[{"data":"","id":"1585266","name":"1585266","children":[]},{"data":"","id":"1099599","name":"1099599","children":[]},{"data":"","id":"1594295","name":"1594295","children":[{"data":"","id":"1134800","name":"1134800","children":[]}]},{"data":"","id":"1473483","name":"1473483","children":[]},{"data":"","id":"1123330","name":"1123330","children":[]}]},{"data":"","id":"1389884","name":"1389884","children":[{"data":"","id":"1775862","name":"1775862","children":[]},{"data":"","id":"1250305","name":"1250305","children":[]},{"data":"","id":"1867524","name":"1867524","children":[]},{"data":"","id":"1021430","name":"1021430","children":[]},{"data":"","id":"1003094","name":"1003094","children":[]}]},{"data":"","id":"1059178","name":"1059178","children":[{"data":"","id":"1244015","name":"1244015","children":[]},{"data":"","id":"1327462","name":"1327462","children":[]},{"data":"","id":"1535839","name":"1535839","children":[]},{"data":"","id":"1393904","name":"1393904","children":[]},{"data":"","id":"1183503","name":"1183503","children":[]}]}]},{"data":"","id":"2584106","name":"2584106","children":[{"data":"","id":"1661766","name":"1661766","children":[]},{"data":"","id":"1003613","name":"1003613","children":[]},{"data":"","id":"1284570","name":"1284570","children":[]},{"data":"","id":"1738516","name":"1738516","children":[{"data":"","id":"2323636","name":"2323636","children":[]},{"data":"","id":"1610369","name":"1610369","children":[]},{"data":"","id":"1449210","name":"1449210","children":[]}]},{"data":"","id":"1194290","name":"1194290","children":[]}]},{"data":"","id":"1471470","name":"1471470","children":[{"data":"","id":"1086302","name":"1086302","children":[]},{"data":"","id":"1487273","name":"1487273","children":[]},{"data":"","id":"1267618","name":"1267618","children":[]},{"data":"","id":"1499489","name":"1499489","children":[]},{"data":"","id":"1142531","name":"1142531","children":[]}]},{"data":"","id":"1102455","name":"1102455","children":[{"data":"","id":"1855864","name":"1855864","children":[]},{"data":"","id":"1736009","name":"1736009","children":[]},{"data":"","id":"1063463","name":"1063463","children":[]},{"data":"","id":"1269976","name":"1269976","children":[]},{"data":"","id":"1025136","name":"1025136","children":[]}]},{"data":"","id":"1821000","name":"1821000","children":[{"data":"","id":"2325386","name":"2325386","children":[]},{"data":"","id":"1228477","name":"1228477","children":[]},{"data":"","id":"1019868","name":"1019868","children":[]},{"data":"","id":"1076475","name":"1076475","children":[]},{"data":"","id":"1960481","name":"1960481","children":[]}]}]},{"data":"","id":"1155375","name":"1155375","children":[{"data":"","id":"1122498","name":"1122498","children":[{"data":"","id":"1536265","name":"1536265","children":[{"data":"","id":"1170976","name":"1170976","children":[]}]},{"data":"","id":"1713710","name":"1713710","children":[]},{"data":"","id":"1314034","name":"1314034","children":[]},{"data":"","id":"1261819","name":"1261819","children":[]},{"data":"","id":"1228300","name":"1228300","children":[]}]},{"data":"","id":"1132247","name":"1132247","children":[{"data":"","id":"1104352","name":"1104352","children":[]},{"data":"","id":"1463406","name":"1463406","children":[]},{"data":"","id":"1084293","name":"1084293","children":[]},{"data":"","id":"1606340","name":"1606340","children":[]},{"data":"","id":"1136222","name":"1136222","children":[]}]},{"data":"","id":"1432026","name":"1432026","children":[{"data":"","id":"1583291","name":"1583291","children":[]},{"data":"","id":"1112204","name":"1112204","children":[]},{"data":"","id":"1222551","name":"1222551","children":[]},{"data":"","id":"1656894","name":"1656894","children":[]}]},{"data":"","id":"1549376","name":"1549376","children":[]},{"data":"","id":"2280687","name":"2280687","children":[]}]},{"data":"","id":"1412321","name":"1412321","children":[{"data":"","id":"1525417","name":"1525417","children":[{"data":"","id":"1707972","name":"1707972","children":[]},{"data":"","id":"2529241","name":"2529241","children":[]},{"data":"","id":"1141507","name":"1141507","children":[]},{"data":"","id":"1176963","name":"1176963","children":[]},{"data":"","id":"2094867","name":"2094867","children":[]}]},{"data":"","id":"1496625","name":"1496625","children":[{"data":"","id":"1357114","name":"1357114","children":[]},{"data":"","id":"1605781","name":"1605781","children":[{"data":"","id":"1114108","name":"1114108","children":[]}]}]},{"data":"","id":"1342651","name":"1342651","children":[]},{"data":"","id":"1202646","name":"1202646","children":[]},{"data":"","id":"2396315","name":"2396315","children":[]}]},{"data":"","id":"1576712","name":"1576712","children":[{"data":"","id":"1205904","name":"1205904","children":[{"data":"","id":"1084457","name":"1084457","children":[]},{"data":"","id":"1008120","name":"1008120","children":[]},{"data":"","id":"1012602","name":"1012602","children":[]},{"data":"","id":"1112250","name":"1112250","children":[]},{"data":"","id":"1330800","name":"1330800","children":[{"data":"","id":"1167134","name":"1167134","children":[]}]}]},{"data":"","id":"1338462","name":"1338462","children":[{"data":"","id":"1117079","name":"1117079","children":[]},{"data":"","id":"1320362","name":"1320362","children":[]},{"data":"","id":"1251778","name":"1251778","children":[]},{"data":"","id":"1242094","name":"1242094","children":[]},{"data":"","id":"1269200","name":"1269200","children":[]}]},{"data":"","id":"1525717","name":"1525717","children":[{"data":"","id":"2735500","name":"2735500","children":[]},{"data":"","id":"1134792","name":"1134792","children":[]},{"data":"","id":"1178056","name":"1178056","children":[]},{"data":"","id":"1053715","name":"1053715","children":[]},{"data":"","id":"1407624","name":"1407624","children":[{"data":"","id":"1693519","name":"1693519","children":[]},{"data":"","id":"1080607","name":"1080607","children":[]},{"data":"","id":"1676008","name":"1676008","children":[]},{"data":"","id":"1039646","name":"1039646","children":[]},{"data":"","id":"1068557","name":"1068557","children":[{"data":"","id":"1133670","name":"1133670","children":[{"data":"","id":"2129992","name":"2129992","children":[]},{"data":"","id":"1311789","name":"1311789","children":[]}]},{"data":"","id":"1135768","name":"1135768","children":[{"data":"","id":"1463993","name":"1463993","children":[]}]},{"data":"","id":"1936660","name":"1936660","children":[]},{"data":"","id":"2087096","name":"2087096","children":[]},{"data":"","id":"1601701","name":"1601701","children":[]}]}]}]},{"data":"","id":"1023057","name":"1023057","children":[{"data":"","id":"1302636","name":"1302636","children":[]},{"data":"","id":"1103648","name":"1103648","children":[]},{"data":"","id":"1277268","name":"1277268","children":[]},{"data":"","id":"1471997","name":"1471997","children":[]}]},{"data":"","id":"1350657","name":"1350657","children":[{"data":"","id":"1041514","name":"1041514","children":[]}]}]},{"data":"","id":"1172090","name":"1172090","children":[{"data":"","id":"1009838","name":"1009838","children":[]},{"data":"","id":"1900229","name":"1900229","children":[{"data":"","id":"1157718","name":"1157718","children":[{"data":"","id":"1018861","name":"1018861","children":[]}]},{"data":"","id":"1292391","name":"1292391","children":[]}]},{"data":"","id":"1027375","name":"1027375","children":[]},{"data":"","id":"1106817","name":"1106817","children":[]},{"data":"","id":"1216317","name":"1216317","children":[]}]}]}]},{"data":"","id":"1329358","name":"1329358","children":[{"data":"","id":"1125792","name":"1125792","children":[{"data":"","id":"1417464","name":"1417464","children":[]},{"data":"","id":"1023610","name":"1023610","children":[]},{"data":"","id":"1265806","name":"1265806","children":[]},{"data":"","id":"1549075","name":"1549075","children":[]},{"data":"","id":"1199611","name":"1199611","children":[]}]},{"data":"","id":"2314358","name":"2314358","children":[{"data":"","id":"1231534","name":"1231534","children":[]},{"data":"","id":"1354563","name":"1354563","children":[]},{"data":"","id":"1478932","name":"1478932","children":[]},{"data":"","id":"1003383","name":"1003383","children":[]},{"data":"","id":"1099792","name":"1099792","children":[]}]},{"data":"","id":"1095563","name":"1095563","children":[{"data":"","id":"1341860","name":"1341860","children":[]},{"data":"","id":"1545466","name":"1545466","children":[]},{"data":"","id":"1571581","name":"1571581","children":[]},{"data":"","id":"1032328","name":"1032328","children":[]},{"data":"","id":"1038287","name":"1038287","children":[]}]},{"data":"","id":"1251027","name":"1251027","children":[{"data":"","id":"1400917","name":"1400917","children":[]},{"data":"","id":"1738183","name":"1738183","children":[]},{"data":"","id":"2520839","name":"2520839","children":[]},{"data":"","id":"1053372","name":"1053372","children":[]},{"data":"","id":"1062576","name":"1062576","children":[]}]},{"data":"","id":"1142860","name":"1142860","children":[{"data":"","id":"1605864","name":"1605864","children":[]},{"data":"","id":"2458233","name":"2458233","children":[]},{"data":"","id":"1494545","name":"1494545","children":[]},{"data":"","id":"1329888","name":"1329888","children":[]},{"data":"","id":"1303566","name":"1303566","children":[]}]}]},{"data":"","id":"1152477","name":"1152477","children":[{"data":"","id":"2378030","name":"2378030","children":[{"data":"","id":"1289818","name":"1289818","children":[]},{"data":"","id":"1166571","name":"1166571","children":[]},{"data":"","id":"1144746","name":"1144746","children":[]},{"data":"","id":"1088135","name":"1088135","children":[]},{"data":"","id":"1142891","name":"1142891","children":[]}]},{"data":"","id":"1186957","name":"1186957","children":[{"data":"","id":"1219277","name":"1219277","children":[{"data":"","id":"1009040","name":"1009040","children":[{"data":"","id":"1414420","name":"1414420","children":[{"data":"","id":"1767543","name":"1767543","children":[]}]},{"data":"","id":"1174264","name":"1174264","children":[]},{"data":"","id":"1255151","name":"1255151","children":[]}]},{"data":"","id":"1467298","name":"1467298","children":[]},{"data":"","id":"1282958","name":"1282958","children":[{"data":"","id":"1820338","name":"1820338","children":[]},{"data":"","id":"1018258","name":"1018258","children":[]},{"data":"","id":"1069690","name":"1069690","children":[]}]},{"data":"","id":"1871088","name":"1871088","children":[]},{"data":"","id":"1086371","name":"1086371","children":[]}]},{"data":"","id":"1173980","name":"1173980","children":[{"data":"","id":"1594015","name":"1594015","children":[]}]},{"data":"","id":"1581449","name":"1581449","children":[]},{"data":"","id":"1702618","name":"1702618","children":[{"data":"","id":"1273227","name":"1273227","children":[]}]},{"data":"","id":"1085355","name":"1085355","children":[]}]},{"data":"","id":"2592289","name":"2592289","children":[{"data":"","id":"1260085","name":"1260085","children":[]},{"data":"","id":"1116893","name":"1116893","children":[]},{"data":"","id":"1855664","name":"1855664","children":[]},{"data":"","id":"1504871","name":"1504871","children":[]},{"data":"","id":"1098229","name":"1098229","children":[]}]},{"data":"","id":"1019010","name":"1019010","children":[{"data":"","id":"2473418","name":"2473418","children":[]},{"data":"","id":"1594551","name":"1594551","children":[]},{"data":"","id":"1782681","name":"1782681","children":[]},{"data":"","id":"1342686","name":"1342686","children":[]},{"data":"","id":"1245799","name":"1245799","children":[]}]},{"data":"","id":"1539617","name":"1539617","children":[{"data":"","id":"2310848","name":"2310848","children":[]},{"data":"","id":"1086789","name":"1086789","children":[]},{"data":"","id":"1480219","name":"1480219","children":[]},{"data":"","id":"1413578","name":"1413578","children":[]},{"data":"","id":"1174924","name":"1174924","children":[]}]}]},{"data":"","id":"1279685","name":"1279685","children":[{"data":"","id":"1783315","name":"1783315","children":[{"data":"","id":"1103343","name":"1103343","children":[{"data":"","id":"1016807","name":"1016807","children":[]},{"data":"","id":"1296323","name":"1296323","children":[]},{"data":"","id":"1050110","name":"1050110","children":[]},{"data":"","id":"1890094","name":"1890094","children":[]},{"data":"","id":"1060956","name":"1060956","children":[{"data":"","id":"1208189","name":"1208189","children":[]}]}]},{"data":"","id":"1301640","name":"1301640","children":[]},{"data":"","id":"1520459","name":"1520459","children":[{"data":"","id":"1064651","name":"1064651","children":[{"data":"","id":"1074509","name":"1074509","children":[]},{"data":"","id":"1087027","name":"1087027","children":[]}]},{"data":"","id":"1435593","name":"1435593","children":[]},{"data":"","id":"1186063","name":"1186063","children":[]},{"data":"","id":"1108434","name":"1108434","children":[]},{"data":"","id":"1261093","name":"1261093","children":[]}]},{"data":"","id":"1212858","name":"1212858","children":[{"data":"","id":"1592801","name":"1592801","children":[]}]},{"data":"","id":"1502576","name":"1502576","children":[]}]},{"data":"","id":"1627556","name":"1627556","children":[{"data":"","id":"1827762","name":"1827762","children":[]},{"data":"","id":"1019719","name":"1019719","children":[]},{"data":"","id":"1091218","name":"1091218","children":[]},{"data":"","id":"1012215","name":"1012215","children":[]},{"data":"","id":"1007817","name":"1007817","children":[]}]},{"data":"","id":"1136538","name":"1136538","children":[{"data":"","id":"1138639","name":"1138639","children":[]},{"data":"","id":"1269126","name":"1269126","children":[]},{"data":"","id":"1185621","name":"1185621","children":[]},{"data":"","id":"1015276","name":"1015276","children":[]},{"data":"","id":"1170479","name":"1170479","children":[]}]},{"data":"","id":"1210318","name":"1210318","children":[{"data":"","id":"1129550","name":"1129550","children":[]},{"data":"","id":"1831014","name":"1831014","children":[]},{"data":"","id":"1710065","name":"1710065","children":[]},{"data":"","id":"1560192","name":"1560192","children":[]},{"data":"","id":"1562531","name":"1562531","children":[]}]},{"data":"","id":"1335102","name":"1335102","children":[{"data":"","id":"1058979","name":"1058979","children":[]},{"data":"","id":"1618329","name":"1618329","children":[]},{"data":"","id":"1025077","name":"1025077","children":[]},{"data":"","id":"1993940","name":"1993940","children":[]},{"data":"","id":"1166809","name":"1166809","children":[]}]}]},{"data":"","id":"1443490","name":"1443490","children":[{"data":"","id":"1288933","name":"1288933","children":[{"data":"","id":"1228340","name":"1228340","children":[]},{"data":"","id":"1170524","name":"1170524","children":[]},{"data":"","id":"1274660","name":"1274660","children":[]},{"data":"","id":"1561675","name":"1561675","children":[]},{"data":"","id":"1937884","name":"1937884","children":[]}]},{"data":"","id":"1150180","name":"1150180","children":[{"data":"","id":"2491153","name":"2491153","children":[]},{"data":"","id":"1499691","name":"1499691","children":[]},{"data":"","id":"1656884","name":"1656884","children":[]},{"data":"","id":"1047717","name":"1047717","children":[]},{"data":"","id":"1235799","name":"1235799","children":[]}]},{"data":"","id":"1059640","name":"1059640","children":[{"data":"","id":"1293351","name":"1293351","children":[]},{"data":"","id":"1551615","name":"1551615","children":[]},{"data":"","id":"1083235","name":"1083235","children":[]},{"data":"","id":"1024154","name":"1024154","children":[]},{"data":"","id":"1100642","name":"1100642","children":[]}]},{"data":"","id":"1387935","name":"1387935","children":[{"data":"","id":"1013830","name":"1013830","children":[]},{"data":"","id":"1059900","name":"1059900","children":[]},{"data":"","id":"1290721","name":"1290721","children":[]},{"data":"","id":"1953376","name":"1953376","children":[]},{"data":"","id":"2438533","name":"2438533","children":[]}]},{"data":"","id":"1724364","name":"1724364","children":[{"data":"","id":"1113154","name":"1113154","children":[]},{"data":"","id":"1629468","name":"1629468","children":[]},{"data":"","id":"1116190","name":"1116190","children":[]},{"data":"","id":"1488055","name":"1488055","children":[]},{"data":"","id":"1069793","name":"1069793","children":[]}]}]}]};

	var json;
	
	$.ajax({
		url:Url('painel/json'),
		type: 'get',
		dataType:'json',
		async:false,
		success:function(jsonPro){
			json = jsonPro;
		}
	})

    //end
    //init Spacetree
    //Create a new ST instance
    var st = new $jit.ST({
        //id of viz container element
        injectInto: 'infovis',
        //set duration for the animation
        duration: 800,
        //set animation transition type
        transition: $jit.Trans.Quart.easeInOut,
        //set distance between node and its children
        levelDistance: 50,
        //enable panning
        Navigation: {
          enable:true,
          panning:true
        },
        //set node and edge styles
        //set overridable=true for styling individual
        //nodes or edges
        Node: {
			width:110,
			height:50,
            type: 'rectangle',
            color: '#aaa',
            overridable: true
        },
        
        Edge: {
            type: 'line',
            overridable: true
        },
        onBeforeCompute: function(node){
            Log.write("Carregando " + node.name);
		},
        onAfterCompute: function(){
            Log.write("Finalizado");
        },
        
        //This method is called on DOM label creation.
        //Use this method to add event handlers and styles to
        //your node.
        onCreateLabel: function(label, node){
            label.id = node.id;            
            label.innerHTML = node.name;
            label.onclick = function(){
            	st.onClick(node.id)
            };
            //set label styles
            var style = label.style;
            style.width = 100 + 'px';
            style.height = 50 + 'px';            
            style.cursor = 'pointer';
            style.color = '#000';
            style.fontSize = '0.8em';
            style.textAlign= 'center';
            style.paddingTop = '5px';
            style.paddingLeft = '5px';
            style.paddingRight = '5px';
        },
        
        //This method is called right before plotting
        //a node. It's useful for changing an individual node
        //style properties before plotting it.
        //The data properties prefixed with a dollar
        //sign will override the global node style properties.
        onBeforePlotNode: function(node){
            //add some color to the nodes in the path between the
            //root node and the selected node.
            if (node.selected) {
                node.data.$color = "#ff7";
            }
            else {
                delete node.data.$color;
                //if the node belongs to the last plotted level
                if(!node.anySubnode("exist")) {
                    //count children number
                    var count = 0;
                    node.eachSubnode(function(n) { count++; });
                    //assign a node color based on
                    //how many children it has
                    node.data.$color = ['#aaa', '#baa', '#caa', '#daa', '#eaa', '#faa'][count];                    
                }
            }
        },
        
        //This method is called right before plotting
        //an edge. It's useful for changing an individual edge
        //style properties before plotting it.
        //Edge data proprties prefixed with a dollar sign will
        //override the Edge global style properties.
        onBeforePlotLine: function(adj){
            if (adj.nodeFrom.selected && adj.nodeTo.selected) {
                adj.data.$color = "#eed";
                adj.data.$lineWidth = 3;
            }
            else {
                delete adj.data.$color;
                delete adj.data.$lineWidth;
            }
        }
    });
    //load json data
    st.loadJSON(json);
    //compute node positions and layout
    st.compute();
    //optional: make a translation of the tree
    st.geom.translate(new $jit.Complex(-200, 0), "current");
    //emulate a click on the root node.
    st.onClick(st.root);
    //end
    //Add event handlers to switch spacetree orientation.
    var top = $jit.id('r-top'), 
        left = $jit.id('r-left'), 
        bottom = $jit.id('r-bottom'), 
        right = $jit.id('r-right'),
        normal = $jit.id('s-normal');
        
    
    function changeHandler() {
        if(this.checked) {
            top.disabled = bottom.disabled = right.disabled = left.disabled = true;
            st.switchPosition(this.value, "animate", {
                onComplete: function(){
                    top.disabled = bottom.disabled = right.disabled = left.disabled = false;
                }
            });
        }
    };
    
    top.onchange = left.onchange = bottom.onchange = right.onchange = changeHandler;
    //end-

}
